<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:fn="http://java.sun.com/jsp/jstl/functions" xmlns:c="http://java.sun.com/jsp/jstl/core">

<h:head>
    <title>Duke's Book Store - Powered by Java EE 7</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <h:outputStylesheet name="title.css"/>
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css"></link>
    <link href="http://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic" rel="stylesheet"
          type="text/css"/>
</h:head>

<ui:composition template="/WEB-INF/templates/common.xhtml">
    <ui:define name="title">Admin</ui:define>
    <ui:define name="content">


        <f:metadata>
            <f:event type="preRenderView" listener="#{bookBean.getBooks()}"/>
        </f:metadata>

        <p:dataTable var="book" value="#{bookBean.books}">
            <p:column headerText="Id">
                <h:outputText value="#{book.id}"/>
            </p:column>

            <p:column headerText="Author">
                <h:outputText value="by "/>
                <ui:repeat value="#{book.authors}" var="author">
                    <h:outputText value="#{author.firstName} #{author.lastName}"/>
                    <c:if test="#{empty book.authors}">
                        ,
                    </c:if>
                </ui:repeat>
            </p:column>

            <p:column headerText="Title">
                <h:outputText value="#{book.title}"/>
            </p:column>

            <p:column headerText="Price">
                <h:outputText value="#{book.price}"/>
            </p:column>

            <p:column headerText="Published">
                <h:outputText value="#{book.published}"/>
            </p:column>

            <p:column headerText="Action">

                <h:commandButton value="delete" action="#{bookBean.deleteBook(book.id)}" />

                <p:commandButton value="update" action="update"/>

            </p:column>
        </p:dataTable>


    </ui:define>
</ui:composition>
</html>
